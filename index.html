<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>PhiloSphere - Wisdom of the Ages</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Crimson+Text:ital,wght@0,400;0,600;0,700;1,400&family=Inter:wght@300;400;500;600&display=swap" rel="stylesheet">
    <script>
      tailwind.config = {
        theme: {
          extend: {
            fontFamily: {
              serif: ['"Crimson Text"', 'Georgia', 'serif'],
              sans: ['"Inter"', 'system-ui', 'sans-serif'],
            },
            colors: {
              stone: {
                50: '#fafaf9',
                100: '#f5f5f4',
                200: '#e7e5e4',
                300: '#d6d3d1',
                400: '#a8a29e',
                500: '#78716c',
                600: '#57534e',
                700: '#44403c',
                800: '#292524',
                900: '#1c1917',
              },
              amber: {
                50: '#fffbeb',
                100: '#fef3c7',
                200: '#fde68a',
                300: '#fcd34d',
                400: '#fbbf24',
                500: '#f59e0b',
                600: '#d97706',
                700: '#b45309',
                800: '#92400e',
                900: '#78350f',
              },
            },
            animation: {
              'fade-in': 'fadeIn 0.5s ease-out',
              'bounce-slow': 'bounce 2s infinite',
            },
            keyframes: {
              fadeIn: {
                '0%': { opacity: '0', transform: 'translateY(10px)' },
                '100%': { opacity: '1', transform: 'translateY(0)' },
              },
            },
          },
        },
      }
    </script>
    <style>
      /* Custom scrollbar for a cleaner look */
      ::-webkit-scrollbar {
        width: 8px;
      }
      ::-webkit-scrollbar-track {
        background: #f5f5f4; 
      }
      ::-webkit-scrollbar-thumb {
        background: #d6d3d1; 
        border-radius: 4px;
      }
      ::-webkit-scrollbar-thumb:hover {
        background: #a8a29e; 
      }
      .line-clamp-2 {
        display: -webkit-box;
        -webkit-line-clamp: 2;
        -webkit-box-orient: vertical;
        overflow: hidden;
      }
    </style>
    <!-- 
      POLYFILL FOR STATIC ENVIRONMENT
      This script mimics the Node.js process environment so the app can run without a build step.
      PLEASE PASTE YOUR GEMINI API KEY BELOW inside the quotes.
    -->
    <script>
      window.process = {
        env: {
          API_KEY: '' // <--- PASTE YOUR API KEY HERE
        }
      };
    </script>
    <script type="importmap">
{
  "imports": {
    "@google/genai": "https://aistudiocdn.com/@google/genai@^1.32.0",
    "react": "https://aistudiocdn.com/react@^19.2.1",
    "react-dom/": "https://aistudiocdn.com/react-dom@^19.2.1/",
    "react/": "https://aistudiocdn.com/react@^19.2.1/"
  }
}
</script>
  </head>
  <body class="bg-[#FDFCF8] text-stone-800 font-sans selection:bg-amber-200 selection:text-amber-900 min-h-screen flex flex-col">
    
    <!-- Header -->
    <header class="sticky top-0 z-50 bg-[#FDFCF8]/90 backdrop-blur-md border-b border-stone-200 transition-all duration-300">
      <div class="max-w-7xl mx-auto px-6 py-4 flex items-center justify-between">
        <div class="flex items-center gap-3 cursor-pointer" onclick="app.goHome()">
           <div class="bg-stone-900 p-2 rounded-lg">
              <!-- Brain Icon -->
              <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="h-6 w-6 text-amber-500">
                <path d="M9.5 2A2.5 2.5 0 0 1 12 4.5v15a2.5 2.5 0 0 1-4.96.44 2.5 2.5 0 0 1-2.96-3.08 3 3 0 0 1-.34-5.58 2.5 2.5 0 0 1 1.32-4.24 2.5 2.5 0 0 1 1.98-3A2.5 2.5 0 0 1 9.5 2Z" />
                <path d="M14.5 2A2.5 2.5 0 0 0 12 4.5v15a2.5 2.5 0 0 0 4.96.44 2.5 2.5 0 0 0 2.96-3.08 3 3 0 0 0 .34-5.58 2.5 2.5 0 0 0-1.32-4.24 2.5 2.5 0 0 0-1.98-3A2.5 2.5 0 0 0 14.5 2Z" />
              </svg>
           </div>
           <div>
             <h1 class="text-2xl font-serif font-bold text-stone-900 leading-none tracking-tight">PhiloSphere</h1>
             <p class="text-xs text-stone-500 font-medium tracking-wide uppercase">Wisdom of the Ages</p>
           </div>
        </div>
        <button onclick="window.location.reload()" class="text-sm font-semibold text-stone-500 hover:text-stone-900 transition-colors" title="Reset App">
          Reset
        </button>
      </div>
    </header>

    <!-- Main Content Container -->
    <main id="app-container" class="flex-grow relative">
      <!-- Views will be injected here -->
    </main>

    <!-- Footer -->
    <footer class="bg-stone-900 text-stone-400 py-12 mt-auto">
      <div class="max-w-7xl mx-auto px-6 text-center">
        <p class="font-serif italic mb-4">"The only true wisdom is in knowing you know nothing."</p>
        <p class="text-sm opacity-60">&copy; <span id="year"></span> PhiloSphere. Powered by Gemini.</p>
      </div>
    </footer>

    <!-- Application Logic -->
    <script type="module">
      import { GoogleGenAI, Type } from "@google/genai";

      // --- Configuration ---
      // This will now work because of the polyfill script in the head
      const API_KEY = process.env.API_KEY; 
      
      let ai;
      try {
        ai = new GoogleGenAI({ apiKey: API_KEY });
      } catch (e) {
        console.error("Failed to initialize Gemini AI. Check API Key.", e);
      }

      // --- State ---
      const state = {
        view: 'loading', // 'loading', 'list', 'detail', 'error'
        philosophers: [],
        selectedId: null,
        detailsCache: {}, // Cache details to avoid re-fetching
        error: null
      };

      // --- Schemas ---
      const summarySchema = {
        type: Type.OBJECT,
        properties: {
          philosophers: {
            type: Type.ARRAY,
            items: {
              type: Type.OBJECT,
              properties: {
                id: { type: Type.STRING },
                name: { type: Type.STRING },
                tagline: { type: Type.STRING },
                era: { type: Type.STRING },
                school: { type: Type.STRING },
              },
              required: ["id", "name", "tagline", "era", "school"],
            },
          },
        },
        required: ["philosophers"],
      };

      const detailSchema = {
        type: Type.OBJECT,
        properties: {
          bio: { type: Type.STRING, description: "A comprehensive 2-paragraph biography." },
          famousWorks: { 
            type: Type.ARRAY, 
            items: { type: Type.STRING },
            description: "List of 3-5 most important books or essays."
          },
          quotes: { 
            type: Type.ARRAY, 
            items: { type: Type.STRING },
            description: "List of 4-6 most famous quotes."
          },
          coreIdeas: {
            type: Type.ARRAY,
            items: { type: Type.STRING },
            description: "3 key philosophical concepts they are known for."
          }
        },
        required: ["bio", "famousWorks", "quotes", "coreIdeas"],
      };

      // --- Icons (SVG Strings) ---
      const Icons = {
        loading: `
          <div class="flex flex-col items-center justify-center p-8 text-stone-600 animate-pulse">
            <div class="relative">
              <div class="absolute inset-0 bg-amber-200 blur-xl opacity-20 rounded-full"></div>
              <svg xmlns="http://www.w3.org/2000/svg" width="64" height="64" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="w-16 h-16 text-amber-700 mb-4 relative z-10 animate-bounce-slow">
                <path d="M9.5 2A2.5 2.5 0 0 1 12 4.5v15a2.5 2.5 0 0 1-4.96.44 2.5 2.5 0 0 1-2.96-3.08 3 3 0 0 1-.34-5.58 2.5 2.5 0 0 1 1.32-4.24 2.5 2.5 0 0 1 1.98-3A2.5 2.5 0 0 1 9.5 2Z" />
                <path d="M14.5 2A2.5 2.5 0 0 0 12 4.5v15a2.5 2.5 0 0 0 4.96.44 2.5 2.5 0 0 0 2.96-3.08 3 3 0 0 0 .34-5.58 2.5 2.5 0 0 0-1.32-4.24 2.5 2.5 0 0 0-1.98-3A2.5 2.5 0 0 0 14.5 2Z" />
              </svg>
            </div>
            <p class="text-xl font-serif italic text-stone-500" id="loading-text">Contemplating...</p>
          </div>
        `,
        book: `<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M4 19.5A2.5 2.5 0 0 1 6.5 17H20" /><path d="M6.5 2H20v20H6.5A2.5 2.5 0 0 1 4 19.5v-15A2.5 2.5 0 0 1 6.5 2z" /></svg>`,
        feather: `<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M20.24 12.24a6 6 0 0 0-8.49-8.49L5 10.5V19h8.5z" /><line x1="16" y1="8" x2="2" y2="22" /><line x1="17.5" y1="15" x2="9" y2="15" /></svg>`,
        quote: `<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M3 21c3 0 7-1 7-8V5c0-1.25-.756-2.017-2-2H4c-1.25 0-2 .75-2 1.972V11c0 1.25.75 2 2 2 1 0 1 0 1 1v1c0 1-1 2-2 2s-1 .008-1 1.031V20c0 1 0 1 1 1z" /><path d="M15 21c3 0 7-1 7-8V5c0-1.25-.757-2.017-2-2h-4c-1.25 0-2 .75-2 1.972V11c0 1.25.75 2 2 2 1 0 1 0 1 1v1c0 1-1 2-2 2s-1 .008-1 1.031V20c0 1 0 1 1 1z" /></svg>`,
        arrowLeft: `<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><line x1="19" y1="12" x2="5" y2="12" /><polyline points="12 19 5 12 12 5" /></svg>`,
        arrowRight: `<svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M14 5l7 7m0 0l-7 7m7-7H3" /></svg>`
      };

      // --- DOM Elements ---
      const container = document.getElementById('app-container');
      const yearSpan = document.getElementById('year');
      if (yearSpan) yearSpan.textContent = new Date().getFullYear();

      // --- API Service ---
      const API = {
        fetchList: async () => {
          if (!ai) throw new Error("Gemini AI not initialized");
          try {
            const response = await ai.models.generateContent({
              model: "gemini-2.5-flash",
              contents: "Generate a list of 12 distinct, famous philosophers from diverse eras and cultures (e.g., Greek, Eastern, Modern, Existentialist).",
              config: {
                responseMimeType: "application/json",
                responseSchema: summarySchema,
                systemInstruction: "You are a helpful philosophy expert. Return clean JSON.",
              },
            });
            const text = response.text;
            if (!text) throw new Error("No response from AI");
            return JSON.parse(text).philosophers;
          } catch (e) {
            console.error(e);
            throw e;
          }
        },
        fetchDetail: async (summary) => {
          if (!ai) throw new Error("Gemini AI not initialized");
          try {
            const response = await ai.models.generateContent({
              model: "gemini-2.5-flash",
              contents: `Provide detailed information about the philosopher ${summary.name} (${summary.era}).`,
              config: {
                responseMimeType: "application/json",
                responseSchema: detailSchema,
                systemInstruction: "You are an expert biographer and philosopher. Provide accurate, insightful, and engaging content.",
              },
            });
            const text = response.text;
            if (!text) throw new Error("No response from AI");
            return { ...summary, ...JSON.parse(text) };
          } catch (e) {
            console.error(e);
            throw e;
          }
        }
      };

      // --- Render Functions ---

      function renderLoading(message = "Contemplating...") {
        container.innerHTML = `
          <div class="min-h-[60vh] flex items-center justify-center">
            ${Icons.loading}
          </div>
        `;
        const textEl = document.getElementById('loading-text');
        if(textEl) textEl.textContent = message;
      }

      function renderError(message) {
        container.innerHTML = `
          <div class="min-h-[60vh] bg-stone-100 flex flex-col items-center justify-center text-center p-4">
            <div class="bg-white p-8 rounded-2xl shadow-xl max-w-md">
               <h2 class="text-2xl font-bold text-red-800 mb-4 font-serif">A Philosophical Paradox</h2>
               <p class="text-stone-600 mb-6">${message}</p>
               <button 
                onclick="window.location.reload()"
                class="px-6 py-2 bg-stone-800 text-stone-100 rounded-lg hover:bg-stone-700 transition"
               >
                 Reload Application
               </button>
               <p class="text-xs text-stone-400 mt-4">Note: Ensure API_KEY is set in the index.html source code.</p>
            </div>
          </div>
        `;
      }

      function renderList(philosophers) {
        let html = `
          <div class="max-w-7xl mx-auto px-6 py-12 animate-fade-in">
            <div class="mb-12 text-center max-w-2xl mx-auto">
              <h2 class="text-4xl md:text-5xl font-serif font-bold text-stone-900 mb-6">
                Meet the Thinkers
              </h2>
              <p class="text-lg text-stone-600 leading-relaxed">
                Explore the lives and ideas of history's most influential philosophers. 
                Click on a card to delve deeper into their biographies, famous works, and timeless quotes.
              </p>
            </div>
            <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-8">
        `;

        philosophers.forEach(p => {
          const seed = encodeURIComponent(p.name);
          const imageUrl = `https://picsum.photos/seed/${seed}/400/500`;
          
          html += `
            <div 
              data-id="${p.id}"
              class="philosopher-card group relative cursor-pointer overflow-hidden rounded-xl bg-stone-100 shadow-md transition-all duration-300 hover:-translate-y-1 hover:shadow-xl hover:shadow-stone-400/50"
            >
              <div class="relative aspect-[4/5] overflow-hidden">
                <img 
                  src="${imageUrl}" 
                  alt="${p.name}"
                  loading="lazy"
                  class="h-full w-full object-cover transition-transform duration-700 group-hover:scale-110 filter sepia-[0.2] group-hover:sepia-0"
                />
                <div class="absolute inset-0 bg-gradient-to-t from-stone-900 via-stone-900/40 to-transparent opacity-80 transition-opacity duration-300 group-hover:opacity-90"></div>
                
                <div class="absolute bottom-0 left-0 right-0 p-6 text-stone-100">
                  <p class="mb-1 text-xs font-bold uppercase tracking-widest text-amber-400 opacity-90">${p.era}</p>
                  <h3 class="mb-1 font-serif text-2xl font-bold leading-tight">${p.name}</h3>
                  <p class="line-clamp-2 text-sm text-stone-300 font-light">${p.tagline}</p>
                </div>
              </div>
              
              <div class="absolute top-4 right-4 translate-x-10 opacity-0 transition-all duration-300 group-hover:translate-x-0 group-hover:opacity-100">
                 <span class="flex h-8 w-8 items-center justify-center rounded-full bg-amber-500 text-stone-900">
                   ${Icons.arrowRight}
                 </span>
              </div>
            </div>
          `;
        });

        html += `</div></div>`;
        container.innerHTML = html;

        // Add Event Listeners to cards
        document.querySelectorAll('.philosopher-card').forEach(card => {
          card.addEventListener('click', () => {
            const id = card.getAttribute('data-id');
            app.goToDetail(id);
          });
        });
      }

      function renderDetail(detail) {
        const seed = encodeURIComponent(detail.name);
        const imageUrl = `https://picsum.photos/seed/${seed}/800/600`;
        
        // Helper for splitting paragraphs
        const bioHtml = detail.bio.split('\n').map(p => `<p class="mb-4">${p}</p>`).join('');
        
        // Helper for works
        const worksHtml = detail.famousWorks.map(w => `
          <li class="bg-white p-4 rounded-lg shadow-sm border border-stone-200 hover:border-amber-300 transition-colors">
            <span class="font-serif text-lg font-medium text-stone-800 italic">${w}</span>
          </li>
        `).join('');

        // Helper for ideas
        const ideasHtml = detail.coreIdeas.map(i => `
          <span class="px-4 py-2 bg-stone-200 text-stone-700 rounded-lg text-sm font-medium">
             ${i}
           </span>
        `).join('');

        // Helper for quotes
        const quotesHtml = detail.quotes.map(q => `
           <figure class="block">
             <blockquote class="font-serif text-lg leading-relaxed italic text-stone-300 border-l-2 border-amber-700 pl-4">
               "${q}"
             </blockquote>
           </figure>
        `).join('');

        const html = `
          <div class="bg-stone-50 animate-fade-in pb-12">
            <!-- Hero -->
            <div class="relative h-[40vh] md:h-[50vh] w-full overflow-hidden">
              <img 
                src="${imageUrl}" 
                alt="${detail.name}" 
                class="h-full w-full object-cover filter brightness-75 sepia-[0.3]"
              />
              <div class="absolute inset-0 bg-gradient-to-b from-transparent via-stone-900/20 to-stone-50"></div>
              
              <!-- Back Button -->
              <div class="absolute top-6 left-6 z-10">
                <button 
                  onclick="app.goHome()"
                  class="flex items-center gap-2 rounded-full bg-stone-900/20 px-4 py-2 text-stone-100 backdrop-blur-md transition-all hover:bg-stone-900/40 hover:pr-6"
                >
                  <div class="w-5 h-5">${Icons.arrowLeft}</div>
                  <span class="font-medium">All Philosophers</span>
                </button>
              </div>

              <!-- Title Block -->
              <div class="absolute bottom-0 left-0 right-0 p-8 md:p-12 max-w-5xl mx-auto">
                 <div class="inline-block px-3 py-1 mb-4 rounded-full bg-amber-500/90 text-stone-900 text-xs font-bold tracking-widest uppercase backdrop-blur-sm">
                  ${detail.school}
                </div>
                <h1 class="text-5xl md:text-7xl font-serif font-bold text-stone-900 mb-2 drop-shadow-sm">
                  ${detail.name}
                </h1>
                <p class="text-xl md:text-2xl text-stone-700 font-light italic max-w-2xl">
                  ${detail.tagline}
                </p>
              </div>
            </div>

            <!-- Content Grid -->
            <div class="max-w-5xl mx-auto px-6 py-12 md:py-16 grid grid-cols-1 md:grid-cols-12 gap-12">
              
              <!-- Left Column -->
              <div class="md:col-span-7 space-y-12">
                <section>
                  <div class="flex items-center gap-3 mb-6">
                    <div class="text-amber-600 h-6 w-6">${Icons.feather}</div>
                    <h2 class="text-2xl font-serif font-bold text-stone-800">Biography</h2>
                  </div>
                  <div class="prose prose-stone prose-lg text-stone-600 leading-relaxed font-light">
                    ${bioHtml}
                  </div>
                </section>

                <section>
                  <div class="flex items-center gap-3 mb-6">
                    <div class="text-amber-600 h-6 w-6">${Icons.book}</div>
                    <h2 class="text-2xl font-serif font-bold text-stone-800">Famous Works</h2>
                  </div>
                  <ul class="grid grid-cols-1 sm:grid-cols-2 gap-4">
                    ${worksHtml}
                  </ul>
                </section>

                <section>
                   <h3 class="text-lg font-serif font-bold text-stone-800 mb-4">Core Ideas</h3>
                   <div class="flex flex-wrap gap-2">
                     ${ideasHtml}
                   </div>
                </section>
              </div>

              <!-- Right Column (Sticky Quotes) -->
              <div class="md:col-span-5 relative">
                <div class="sticky top-24">
                  <div class="bg-stone-900 text-stone-200 rounded-2xl p-8 shadow-xl relative overflow-hidden">
                     <div class="absolute top-4 right-4 text-stone-800 h-32 w-32 opacity-20 transform rotate-12">${Icons.quote}</div>
                     
                     <h2 class="text-2xl font-serif font-bold text-amber-500 mb-8 relative z-10 flex items-center gap-2">
                       <div class="h-6 w-6">${Icons.quote}</div> Wisdom
                     </h2>

                     <div class="space-y-8 relative z-10">
                       ${quotesHtml}
                     </div>
                  </div>
                </div>
              </div>

            </div>
          </div>
        `;
        container.innerHTML = html;
        window.scrollTo(0,0);
      }

      // --- Application Controller ---
      const app = {
        init: async () => {
          renderLoading("Gathering the great minds of history...");
          try {
            state.philosophers = await API.fetchList();
            state.view = 'list';
            renderList(state.philosophers);
          } catch (e) {
            state.view = 'error';
            renderError("Failed to load the great minds. Please try again later.");
          }
        },

        goHome: () => {
          state.view = 'list';
          state.selectedId = null;
          renderList(state.philosophers);
          window.scrollTo(0,0);
        },

        goToDetail: async (id) => {
          const summary = state.philosophers.find(p => p.id === id);
          if (!summary) return;

          state.selectedId = id;
          state.view = 'loading';
          renderLoading(`Consulting the archives for ${summary.name}...`);

          try {
            // Check cache
            if (state.detailsCache[id]) {
               renderDetail(state.detailsCache[id]);
            } else {
               const detail = await API.fetchDetail(summary);
               state.detailsCache[id] = detail;
               renderDetail(detail);
            }
            state.view = 'detail';
          } catch (e) {
            renderError("Failed to commune with the spirits of wisdom.");
          }
        }
      };

      // Expose app to window for inline onclick handlers
      window.app = app;

      // Start
      app.init();

    </script>
  </body>
</html>